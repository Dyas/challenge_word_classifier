module.exports={init:init,test:test,};var dict;var boost;var max_pooling=function(d,g,h){var c=[];for(var f=0;f+g<=d.length;f+=h){c.push([])}for(var f=0;f<d[0].length;f++){var a=0;for(var e=0;e+g<=d.length;e+=h){c[a].push(d[e][f]);for(var b=1;b<g;b++){c[a][f]=Math.max(c[a][f],d[e+b][f])}a+=1}}return c};var linear=function(){var a={};a.weights=[];a.in_n=0;a.out_n=0;a.bias=[];a.load=function(f,g,d,e){a.in_n=d;a.out_n=e;for(var c=0;c<d;c++){a.weights.push([]);for(var b=0;b<e;b++){a.weights[c].push(f.readFloatLE(g));g+=4}}for(var c=0;c<e;c++){a.bias.push(f.readFloatLE(g));g+=4}return g};a.forward=function(c){var b=[];for(var e=0;e<a.out_n;e++){b.push(a.bias[e])}for(var e=0;e<a.in_n;e++){for(var d=0;d<a.out_n;d++){b[d]+=c[e]*a.weights[e][d]}}return b};return a};var tanh=function(b){var a=[];for(var d=0;d<b.length;d++){if(typeof b[d]=="number"){a.push(Math.tanh(b[d]))}else{a.push([]);for(var c=0;c<b[d].length;c++){a[d].push(Math.tanh(b[d][c]))}}}return a};var Filter=function(){var a={};a.width=0;a.depth=0;a.bias=[];a.weights=[];a.build_weight=function(c,d){a.width=c;a.depth=d;for(var b=0;b<c;b++){a.weights.push([])}};a.load_weight=function(c,d,b){a.weights[b].push(c.readFloatLE(d));d+=4;return d};a.load_bias=function(b,c){a.bias.push(b.readFloatLE(c));c+=4;return c};a.forward=function(d){var c=[];for(var f=0;f<a.bias.length;f++){var g=a.bias[f];for(var e=0;e<a.width;e++){for(var b=0;b<a.depth;b++){g+=a.weights[e][b]*d[f+e][b]}}c.push(g)}return c};return a};var convolution=function(){var a={};a.width=0;a.depth=0;a.filters=[];a.load=function(l,g,b,h,d,o){a.width=b;a.depth=h;for(var m=0;m<d;m++){var c=Filter();c.build_weight(b,h);a.filters.push(c)}for(var m=0;m<b;m++){for(var f=0;f<h;f++){for(var e=0;e<d;e++){g=a.filters[e].load_weight(l,g,m,f)}}}for(var m=0;m<o;m++){for(var f=0;f<d;f++){g=a.filters[f].load_bias(l,g)}}return g};a.forward=function(c){var b=[];for(var f=0;f<c.length-a.width+1;f++){b.push([])}for(var f=0;f<a.filters.length;f++){var e=a.filters[f].forward(c);for(var d=0;d<b.length;d++){b[d].push(e[d])}}return b};return a};var transform=function(e){var a=[];for(var c=0;c<24;c++){a.push([]);for(var b=0;b<27;b++){a[c].push(0)}}for(var c=0;c<e.length;c++){var d=e.charCodeAt(c);if(d>=97&&d<=122){a[c][d-97]=1}else{a[c][26]=1}}return a};var flatten=function(b){var a=[];for(var d=0;d<b.length;d++){for(var c=0;c<b[d].length;c++){a.push(b[d][c])}}return a};function network(){var a={};a.cnn1=convolution();a.cnn2=convolution();a.linear1=linear();a.linear2=linear();a.linear3=linear();a.load=function(b,c){c=a.cnn1.load(b,c,5,27,8,20);c=a.cnn2.load(b,c,3,8,8,8);c=a.linear1.load(b,c,32,8);c=a.linear2.load(b,c,8,8);c=a.linear3.load(b,c,8,1);return c};a.forward=function(c){var b=transform(c);b=a.cnn1.forward(b);b=tanh(max_pooling(b,2,2));b=a.cnn2.forward(b);b=tanh(max_pooling(b,2,2));b=tanh(a.linear1.forward(flatten(b)));b=tanh(a.linear2.forward(b));b=tanh(a.linear3.forward(b));return b[0]};return a}function booster(){var a={};a.n=5;a.weights=[];a.classifiers=[];a.predict=function(c){var d=0;for(var b=0;b<a.n;b++){d+=a.weights[b]*a.classifiers[b].forward(c)}return d>=0};a.load=function(c,e){for(var b=0;b<a.n;b++){a.weights.push(c.readFloatLE(e));e+=4}for(var b=0;b<a.n;b++){var d=network();e=d.load(c,e);a.classifiers.push(d)}return e};return a}function init(c){boost=booster();var d=boost.load(c,0);var b=c.slice(d,c.length).toString().split("\n");dict={};for(var a=0;a<b.length;a++){if(b[a].length>0){dict[b[a]]=true}}}function test(a){a=a.toLowerCase();if(a.length<=2){if(a.indexOf("'")>=0){return false}return a.length==1||(a.length==2&&(dict[a]?false:true))}if(a.length<=24){return boost.predict(a)}return dict[a]?true:false};