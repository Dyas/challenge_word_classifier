# Description

This solution to the Hola [JS Challenge Spring 2016](https://github.com/hola/challenge_word_classifier) is based around a tiny [stemmer](https://en.wikipedia.org/wiki/Stemming), a Bloom filter and several heuristics to pre-reject some words before they reach the filter. The stemmer was generated by starting with around a hundred regular expressions matching English affixes and running `optimize-patterns.tcl` on them to see how disabling each affected the score on 50000 test cases. The heuristics are

* Word length;
* [Bigram](https://en.wikipedia.org/wiki/N-gram) frequency (see `ngrams.tcl` for the generator);
* Vowel to consonant ratio;
* Apostrophe use.

The release (submitted) version of the module, `classifier_bloom_release.js`, is automatically generated from `classifier_bloom.js` by removing the portions between `/* BEGIN_SKIP */` and `/* END_SKIP */`, substituting the data from `metadata`, converting ES2015 code to ES5 with [Babel](https://babeljs.io/) and then minifying the ES5 code with Google's [Closure Compiler](https://developers.google.com/closure/compiler/). Run `make classifier_bloom_release.js` to generate it.

The module `classifier_bloom.js` can be activated by `main.js` in one of two modes: "learn" and "test"; `classifier_bloom_release.js` only includes the code for the test mode. In the "learn" mode the module generates the data file `buckets` from `words.txt`; in the "test" mode `main.js` tests the module against the test cases (which it expects to find in JSON files the in the directory `data/`) and reports its score. Run `make learn` and `mark test` respectively to activate them.

# Setup

To fully set up an environment in which you can play test with the module on most Linux distributions run the following commands in the same directory as this `README.md` file:

```bash
curl https://raw.githubusercontent.com/hola/challenge_word_classifier/master/words.txt | tr '[:upper:]' '[:lower:]' > words.txt
mkdir data
cd data
for i in `seq 100`; do wget --trust-server-names https://hola.org/challenges/word_classifier/testcase; done
cd ..
make learn
make test
# You need Closure Compiler available as the command 'closure-compiler' to build the release.
# On Fedora run `sudo dnf install -y closure-compiler` to install it.
npm install
make test-release
```

# License

MIT.

Third-party code from the following sources is incorporated in the module:

* <https://github.com/jasondavies/bloomfilter.js> (three-clause BSD-licensed)
