var EMPTY_CHAR=0;var netWeigths;var stringLength;function init(b){var a;a=b;if(b instanceof Buffer){a=b.toString()}else{if(b instanceof String||typeof b==="string"){a=b}else{if(b instanceof Object){a=JSON.stringify(b)}}}netWeigths=JSON.parse(a);stringLength=netWeigths[0].length-1}function test(c){var d,b,a;c=c.toLowerCase();if(heuristic(c)){a=false}else{d=word2vec(stem(c));b=runAnn(d,netWeigths);if(b>=0){a=true}else{a=false}}return a}function heuristic(b){var a;if(b.length>30){return true}a=/('.*){3,}/;if(a.test(b)){return true}a=/('.*){2,}/;if(a.test(b)){a=/(o')|('s)/;if(!a.test(b)){return true}}return false}function replaceAt(c,a,b){return c.substr(0,a)+b+c.substr(a+b.length)}function normalizeChar(e){var d=EMPTY_CHAR,b=-0.9,a=1.8/29;switch(e){case"a":d=b+a*0;break;case"e":d=b+a*1;break;case"i":d=b+a*2;break;case"o":d=b+a*3;break;case"u":d=b+a*4;break;case"y":d=b+a*5;break;case"b":d=b+a*6;break;case"c":d=b+a*7;break;case"d":d=b+a*8;break;case"f":d=b+a*9;break;case"g":d=b+a*10;break;case"h":d=b+a*11;break;case"j":d=b+a*12;break;case"k":d=b+a*15;break;case"l":d=b+a*16;break;case"m":d=b+a*17;break;case"n":d=b+a*18;break;case"p":d=b+a*19;break;case"q":d=b+a*20;break;case"r":d=b+a*21;break;case"s":d=b+a*22;break;case"t":d=b+a*23;break;case"v":d=b+a*24;break;case"w":d=b+a*25;break;case"x":d=b+a*26;break;case"z":d=b+a*27;break;case"'":d=b+a*29;break}return d}function word2vec(c){var b=[];for(var a=0;a<stringLength;a++){b[a]=normalizeChar(c.charAt(a))}return b}function runAnn(h,i){var d=i.length,a;function f(k){return(2/(1+Math.exp(-2*k))-1)}function b(){var k={inputs:[],weigths:[],output:0,steepness:0.5,isBias:false};k.compute=function(){var m=0;if(this.weigths.length>0){for(var l=0;l<this.inputs.length;l++){m+=this.inputs[l]*this.weigths[l]}this.output=f(m*this.steepness)}if(this.isBias){this.output=1}return this.output};return k}a=[];for(var e=0;e<d;e++){a[e]=[];for(var c=0;c<i[e].length;c++){a[e][c]=new b;a[e][c].weigths=i[e][c];if(c==i[e].length-1){a[e][c].isBias=true}}}for(var c in a[0]){if(!a[0][c].isBias){a[0][c].output=h[c]}}for(var e=1;e<d;e++){for(var g=0;g<a[e].length;g++){for(var j=0;j<a[e-1].length;j++){if(!a[e][g].isBias){a[e][g].inputs[j]=a[e-1][j].compute()}}}}return a[d-1][0].compute()}function stem(p){function o(){return{b:"",k:0,j:0}}function d(r,m){switch(r.b.charAt(m)){case"a":case"e":case"i":case"o":case"u":return false;case"y":return(m==0)?true:!d(r,m-1);default:return true}}function n(u){var v=0,r=0,m=u.j;while(true){if(r>m){return v}if(!d(u,r)){break}r++}r++;while(true){while(true){if(r>m){return v}if(d(u,r)){break}r++}r++;v++;while(true){if(r>m){return v}if(!d(u,r)){break}r++}r++}}function i(u){var m=u.j,r;for(r=0;r<=m;r++){if(!d(u,r)){return true}}return false}function k(r,m){if(m<1){return false}if(r.b.charAt(m)!=r.b.charAt(m-1)){return false}return d(r,m)}function q(u,m){var r=u.b.charAt(m);if(m<2||!d(u,m)||d(u,m-1)||!d(u,m-2)){return false}if(r=="w"||r=="x"||r=="y"){return false}return true}function j(v,r){var u=r.length,m=v.k;if(!v.b.substring(0,m+1).endsWith(r)){return false}v.j=m-u;return true}function h(v,r){var u=r.length,m=v.j;v.b=v.b.substring(0,m+1)+r+v.b.substring(m+u+1);v.k=m+u}function l(r,m){if(n(r)>0){h(r,m)}}function f(r){var m="'s";if(r.b.endsWith(m)){r.b=r.b.slice(0,-2)}r.k=r.b.length-1}function s(r){if(r.b.charAt(r.k)=="s"){if(j(r,"sses")){r.k-=2}else{if(j(r,"ies")){h(r,"i")}else{if(r.b.charAt(r.k-1)!="s"){r.k--}}}}if(j(r,"eed")){if(n(r)>0){r.k--}}else{if((j(r,"ed")||j(r,"ing"))&&i(r)){r.k=r.j;if(j(r,"at")){h(r,"ate")}else{if(j(r,"bl")){h(r,"ble")}else{if(j(r,"iz")){h(r,"ize")}else{if(k(r,r.k)){r.k--;var m=r.b.charAt(r.k);if(m=="l"||m=="s"||m=="z"){r.k++}}else{if(n(r)==1&&q(r,r.k)){h(r,"e")}}}}}}}}function g(m){if(j(m,"y")&&i(m)){m.b=replaceAt(m.b,m.k,"i")}}function e(m){switch(m.b.charAt(m.k-1)){case"a":if(j(m,"ational")){l(m,"ate");break}if(j(m,"tional")){l(m,"tion");break}break;case"c":if(j(m,"enci")){l(m,"ence");break}if(j(m,"anci")){l(m,"ance");break}break;case"e":if(j(m,"izer")){l(m,"ize");break}break;case"l":if(j(m,"bli")){l(m,"ble");break}if(j(m,"alli")){l(m,"al");break}if(j(m,"entli")){l(m,"ent");break}if(j(m,"eli")){l(m,"e");break}if(j(m,"ousli")){l(m,"ous");break}break;case"o":if(j(m,"ization")){l(m,"ize");break}if(j(m,"ation")){l(m,"ate");break}if(j(m,"ator")){l(m,"ate");break}break;case"s":if(j(m,"alism")){l(m,"al");break}if(j(m,"iveness")){l(m,"ive");break}if(j(m,"fulness")){l(m,"ful");break}if(j(m,"ousness")){l(m,"ous");break}break;case"t":if(j(m,"aliti")){l(m,"al");break}if(j(m,"iviti")){l(m,"ive");break}if(j(m,"biliti")){l(m,"ble");break}break;case"g":if(j(m,"logi")){l(m,"log");break}}}function c(m){switch(m.b.charAt(m.k)){case"e":if(j(m,"icate")){l(m,"ic");break}if(j(m,"ative")){l(m,"");break}if(j(m,"alize")){l(m,"al");break}break;case"i":if(j(m,"iciti")){l(m,"ic");break}break;case"l":if(j(m,"ical")){l(m,"ic");break}if(j(m,"ful")){l(m,"");break}break;case"s":if(j(m,"ness")){l(m,"");break}break}}function b(m){switch(m.b.charAt(m.k-1)){case"a":if(j(m,"al")){break}return;case"c":if(j(m,"ance")){break}if(j(m,"ence")){break}return;case"e":if(j(m,"er")){break}return;case"i":if(j(m,"ic")){break}return;case"l":if(j(m,"able")){break}if(j(m,"ible")){break}return;case"n":if(j(m,"ant")){break}if(j(m,"ement")){break}if(j(m,"ment")){break}if(j(m,"ent")){break}return;case"o":if(j(m,"ion")&&(m.b.charAt(m.j)=="s"||m.b.charAt(m.j)=="t")){break}if(j(m,"ou")){break}return;case"s":if(j(m,"ism")){break}return;case"t":if(j(m,"ate")){break}if(j(m,"iti")){break}return;case"u":if(j(m,"ous")){break}return;case"v":if(j(m,"ive")){break}return;case"z":if(j(m,"ize")){break}return;default:return}if(n(m)>1){m.k=m.j}}function a(r){r.j=r.k;if(r.b.charAt(r.k)=="e"){var m=n(r);if(m>1||m==1&&!q(r,r.k-1)){r.k--}}if(r.b.charAt(r.k)=="l"&&k(r,r.k)&&n(r)>1){r.k--}}function t(r){var u=new o,m=r.length-1;if(m<=1){return r}r=r.toLowerCase();u.b=r;u.k=m;f(u);s(u);g(u);e(u);c(u);b(u);a(u);return u.b.substring(0,u.k+1)}return t(p)}module.exports={init:init,test:test};